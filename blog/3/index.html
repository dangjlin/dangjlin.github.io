
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>丹哥的技術培養皿</title>
  <meta name="author" content="Daniel Lin 丹哥">

  
  <meta name="description" content="本篇原文來自於日本知名食譜網站 cookpad 的部落格:
新卒ソフトウェアエンジニアのための技術書100冊 http://techlife.cookpad.com/entry/2015/03/31/093000 以下為粗略的大意上的翻譯，提供給自己及朋友閱讀。 應該會有一些小錯誤，敬請見諒。 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dangjlin.github.io/blog/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="丹哥的技術培養皿" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47039951-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">丹哥的技術培養皿</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="dangjlin.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2015/04/03/technical-books-to-the-newly-graduated-software-engineer-100-copies/">給新畢業的軟體工程師的技術書籍100冊LIST</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-03T13:00:00+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>1:00 pm</span></time>
        
           | <a href="/posts/2015/04/03/technical-books-to-the-newly-graduated-software-engineer-100-copies/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2015/04/03/technical-books-to-the-newly-graduated-software-engineer-100-copies/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>本篇原文來自於日本知名食譜網站 cookpad 的部落格:
<a href="http://techlife.cookpad.com/entry/2015/03/31/093000">新卒ソフトウェアエンジニアのための技術書100冊 http://techlife.cookpad.com/entry/2015/03/31/093000 </a>
以下為粗略的大意上的翻譯，提供給自己及朋友閱讀。 應該會有一些小錯誤，敬請見諒。</p>

<hr />

<p>春天阿，就是新鮮人的季節。 這個部落格的讀者群當中的你們，明天開始也是會有要以工程師為職業踏進社會的人吧? 我們COOKPAD也準備好了要迎接新的夥伴們了，準備工作的其中一部分呢，我們製作了「給新畢業的軟體工程師技術書100冊LIST」。</p>

<p>這100冊，是給那些以職業軟體工程師作為職業發展的累積為方向的人，若你們苦惱於應該讀哪些書的話，我們做了一個讓你們大家首先可以從這個LIST裡面去選擇的提案。</p>

<p>在這個LIST裡面，一些是依照興趣、一些是依照我自己的主意來放進去的，雖然我相信你們會安心和氣地接受這份清單，然而還是要提一下，我是用一種認為身為一個職業的Programmer應該要知道哪些知識的心情來蒐集這個LIST的。</p>

<p>我只會取那些被稱為經典的書籍、然後會避免那些獨立學習時難以理解的電腦書籍。 雖然有許多都是被稱作必讀的書，但是有可能有一些書都已經絕版或者是有難以入手的情況存在的話，這樣這些書我也不會放到LIST裡面來。 （我是真的很希望你們能讀這些書的，因此） 我也會避免列一些英文(外文)的書籍。</p>

<p>而且，為了方便查閱，我也做了分類和難易度的區分。 沒有星星的標記的項目，則是那些就算不是以作為軟體工程師為目標的人也都是會看得懂的書。 一顆星的呢，則是入門者可以看得懂的書，隨著星星數量的增加，表示這些書的難度就越趨困難。</p>

<p>這100冊書，都是相當值得一讀的。 雖然如此阿，但是隨著經驗的不同，有些書可能也是會有看不懂、無法理解的時候。我想，我們所不理解的事情、不知道的事情被寫在書裏面這當然是理所當然的阿。</p>

<p>有一個我們社內很尊敬的軟體工程師前輩，ただただしさん也是在 「電腦的名著，古典100冊改訂新板」這本書裡面的一篇文章提到，讀技術的書，一定會有 <strong>&ldquo; 阿~~怎麼都看不懂 &rdquo;</strong> 這樣的經驗。 然後，關於會讓你產生這種感覺的這種書，是因為書裡面的內容是那種  「只讀一次是會讀不懂的書，先放下一會兒，然後再回來讀一讀，之後他能產生的價值可是會以數倍的回報」的內容阿!!</p>

<p>軟體工程師的工作是很困難的，在很多時候，我們必須要具備各式各樣的知識去應對問題。 因此，請務必讓這100冊的書能夠陪伴你成功的職涯之路。</p>

<p>(以下是各分類的日文-中文對照, 幫助大家看自己有興趣的分類)</p>

<p>アルゴリズム : algorithm 演算法
エッセイ:  essay
オブジェクト指向 :  object oriented  : 物件導向
サービス開発 :  Service 開發
セキュリティ:  Security 安全
ソフトウェア開発:  Software 開發
データベース : Database
デザイン : Design
テスト  :  Test 測試
ネットワーク : Network
バージョン管理 : Version 管理 , 版本管理
プログラミング : Programming
プロジェクト : Project 專案
関数プログラミング :  Funtional Programming
機械学習 :  Machine Learning
数学 : 數學
設計 : Design</p>

<hr />

<p>書的LIST 請連到cookpad 的 blog 去看喔。 我就不複製貼上到我這裡來了，裡面的書都是日文的， 有一些是日文原著，有一些是從英文翻譯成日文的，所以有一些可以找英文版來看噢。
<a href="http://techlife.cookpad.com/entry/2015/03/31/093000">新卒ソフトウェアエンジニアのための技術書100冊 http://techlife.cookpad.com/entry/2015/03/31/093000 </a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/08/12/on-cross-model-query-in-the-view-helper-and-orm-object-converted-to-an-array-of-practices/">關於view 及helper內跨model 查詢及 ORM Object 轉換為array 的作法, View Partial 筆記</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-12T08:09:00+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:09 am</span></time>
        
           | <a href="/posts/2014/08/12/on-cross-model-query-in-the-view-helper-and-orm-object-converted-to-an-array-of-practices/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/08/12/on-cross-model-query-in-the-view-helper-and-orm-object-converted-to-an-array-of-practices/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近在處理一個需求，如果我們有三個 model , 三個table 分別叫做 patents and splitwordAs and splitwordBs
第一個表是用來存所有的查詢資料，包括 id , apply_number, patent_content (文章的欄位) &hellip;etc ..  不過這個表不重要，不是這次的重點
第二、三個表是用來存切割文章用的關鍵詞，但是因為又有必須分階段切割段落的需求，還區分為兩大類， 所以就有splitwordAs &amp; splitwordBs 這兩個表用來存放關鍵詞。<br/>
第二、三個表和第一個表是沒有任何的 association 關聯性的。
一開始為了到底要怎麼在 Controller 內去查詢不同的 model 資料感到痛苦萬分，一直覺得無法完成，原本的觀念以為 abc controller 只能存取 abc model，後來才發現觀念錯誤，根本就異常的簡單。這代表著觀念不清楚就會花很多冤枉路一直查詢。當然如果一個controller 內充滿了去查詢各式各樣的model好像也很不正確，應該可以用別種手法去更精簡的撰寫。 似乎是叫做 decorator or presenter 的 design pettern  ? 不太確定是否有相關。</p>

<p>言歸正傳，其實只要在 patent controller 裡面下查詢的code，那麼，在 patent 的 view &amp; helper 內就可以任意使用了</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">show</span>
</span><span class='line'><span class="p">(</span><span class="err">前略</span><span class="p">)</span>
</span><span class='line'>   <span class="vi">@first_key</span> <span class="o">=</span> <span class="no">Keyworda</span><span class="o">.</span><span class="n">where</span><span class="o">.</span><span class="n">not</span><span class="p">(</span><span class="s1">&#39;keyworda&#39;</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s1">&#39;priority asc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pluck</span><span class="p">(</span><span class="ss">:keyworda</span><span class="p">)</span>
</span><span class='line'> <span class="vi">@second_key</span> <span class="o">=</span> <span class="no">Keywordb</span><span class="o">.</span><span class="n">where</span><span class="o">.</span><span class="n">not</span><span class="p">(</span><span class="s1">&#39;keywordb&#39;</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s1">&#39;priority asc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pluck</span><span class="p">(</span><span class="ss">:keywordb</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>而且透過 pluck 的 method, 可以去透過 activerecord 去抓出我們要的欄位內容，比如說，我這邊只需要每個表裡面的每一個關鍵詞， pluck 會回傳為一個 array , 方便我們之後運用。
這邊還要注意， order 的 method 要放在 where之後，最後才能接 pluck 的method ，否則會出現錯誤。</p>

<p>另外，透過這次的實驗，我才知道 controller 裡面去指揮 activereocrd 取到資料之後， view 不用說，當然可以直接用這資料。這次發現 helper 也可以用，真是太棒了。我原本以為 controller 的資料一定必須得先傳去 view , 然後我們必須透過 call method 的方式把 值<strong>當作參數</strong>  傳入 helper 內的 method 。 如果真得必須這樣做，那實在是太麻煩了。
在查詢的過程當中，反而發現其實大多數人比較有問題的是，如何讓屬於 view 的 helper 可以讓 controller 或 model 用呢?</p>

<p>另外筆記一下 view 裡面去 render 兩個區塊，分別是放在不同目錄下的 partial 檔案
我的需求是， 我有一個主版面，要同時顯示兩個不同 model 的 table 資料,  或是 要同時顯示兩個 form 。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span> <span class="err">增加斷詞組</span> <span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-md-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= render :partial =&gt; &quot;keywordas/ne</span><span class="n">w</span><span class="s2">&quot;, locals: {keyworda: @keyworda} %&gt;</span>
</span><span class='line'><span class="s2">  &lt;/div&gt;</span>
</span><span class='line'><span class="s2">   &lt;div class=&quot;</span><span class="n">col</span><span class="o">-</span><span class="n">md</span><span class="o">-</span><span class="mi">6</span><span class="s2">&quot;&gt;</span>
</span><span class='line'><span class="s2">    &lt;%= render :partial =&gt; &quot;</span><span class="n">keywordbs</span><span class="o">/</span><span class="kp">new</span><span class="s2">&quot;, locals: {keywordb: @keywordb} %&gt;</span>
</span><span class='line'><span class="s2">  &lt;/div&gt;</span>
</span><span class='line'><span class="s2">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>這段code表示在另外兩個目錄 <code>keywordas</code> , <code>keywordbs</code> 有  _new.html.erb 這樣的 partial file
<strong>Partial file 要記得底線!!!</strong></p>

<p>keywordas/html _new.html.erb</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= form_for(keyworda, url: keywordas_path) do |f| %&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:keyworda</span>  <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">    &lt;%= f.text_field :keyworda %&gt;</span>
</span><span class='line'>    <span class="o">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="s2">&quot; 增加第一步斷詞 &quot;</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;btn btn-large btn-primary&quot;</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;% end %&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>from rails guide 的說明，放在這邊一起讀作為註解 ，否則每次貼的 code 變數名稱與值都是相同的命名，實在搞不清楚哪個是哪個。</p>

<h2>3.4.6 區域變數</h2>

<p>要在局部頁面裡使用區域變數，在呼叫局部頁面時使用 :as 選項：</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;%=</span> <span class="n">render</span> <span class="ss">partial</span><span class="p">:</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="ss">collection</span><span class="p">:</span> <span class="vi">@products</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="ss">:item</span> <span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>這樣修改以後，可以在局部頁面裡，用 item 來存取到 @products 集合裡的成員。也可以使用 locals: {} 選項，給任何的局部頁面，傳入隨意的區域變數。</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;%=</span> <span class="n">render</span> <span class="ss">partial</span><span class="p">:</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="ss">collection</span><span class="p">:</span> <span class="vi">@products</span><span class="p">,</span>
</span><span class='line'>           <span class="ss">as</span><span class="p">:</span> <span class="ss">:item</span><span class="p">,</span> <span class="ss">locals</span><span class="p">:</span> <span class="p">{</span><span class="ss">title</span><span class="p">:</span> <span class="s2">&quot;Products Page&quot;</span><span class="p">}</span> <span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>在這個情況裡，局部頁面裡可以存取到 title 區域變數，值是 &ldquo;Products Page"。
Rails 也給傳入集合的局部頁面，提供了一個計數器變數。名稱是集合名加上 _counter。譬如在算繪 @products 時，可以在局部頁面裡使用 product_counter，來知道局部頁面被算繪了幾次。但不能和 as: :value 選項一起使用。</p></blockquote>

<p>補充說明
collection: 的意思是</p>

<blockquote><p>3.4.5 算繪集合
局部頁面在算繪集合時非常有用。當使用 :collection 選項，會把集合的每個元素插入的局部頁面裡：</p></blockquote>

<p>html index.html.erb</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Products</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'><span class="sr">&lt;%= render partial: &quot;product&quot;, collection: @products %&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>html _product.html.erb</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="no">Product</span> <span class="ss">Name</span><span class="p">:</span> <span class="o">&lt;%=</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="sx">%&gt;&lt;/p&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>當局部頁面傳入複數形式的集合時，可以在局部頁面裡透過與局部頁面同名的變數來存取到集合的成員。上例裡，局部頁面是 _product，product 則是當下被算繪的實體。</p>

<p>算繪集合有簡寫形式。假設 @products 是 product 實體的集合，則在 index.html.erb 可以這麼寫：</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Products</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'><span class="sr">&lt;%= render @products %&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/08/08/perfume-love-taiwan/">Perfume - Love Taiwan !!</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-08T14:10:00+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:10 pm</span></time>
        
           | <a href="/posts/2014/08/08/perfume-love-taiwan/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/08/08/perfume-love-taiwan/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://www.flickr.com/photos/yettie/14879387003" title="2014-08-08 22.05.12 by Daniel Lin, on Flickr"><img src="https://farm4.staticflickr.com/3903/14879387003_043d21cfc2_b.jpg" width="800" height="768" alt="2014-08-08 22.05.12"></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/30/-rails-in-view-of-each-loop-n-plus-1-queries-problem-solution/">發生在 View內的each 迴圈 - Rails N+1 Queries 問題解法</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-30T03:27:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:27 am</span></time>
        
           | <a href="/posts/2014/07/30/-rails-in-view-of-each-loop-n-plus-1-queries-problem-solution/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/30/-rails-in-view-of-each-loop-n-plus-1-queries-problem-solution/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前幾天在 Rails Tuesday 聚會的時候，與一個朋友在討論 code ，本來是在討論 many to many 的 association 時，要如何在中介的table 當中去查詢到另一個table的欄位資料， 例如，有一個table叫做，使用者，一個table叫做商品，我們有使用者可以有很多商品，商品也可以有很多使用者，是多對多的關係，因此我們可能會create 一個中介 table 叫做 user_product ，裡面就只有 user_id &amp; product_id 兩個欄位，  但是如果我們希望可以拿到 product.name 時該怎麼做呢? 或者是如果我們在中介 table 內增加一欄了，那要怎麼拿出這一欄呢?  本篇文章沒有要討論這個問題。</p>

<p>因此拿出了 intermediate 課程當中的購物車的 code ， 當打開放入購物車的 index 頁面 code 時，朋友問我說在view 裡面使用 .each  然後還去關聯另一個table 這樣會造成一直重複查詢，我才想到這可能有<strong>n+1 query (N+1查詢)</strong> 的問題。
經過百思不得其解的奮鬥之後，初步上得到在 view file 內可以使用 includes 的功能去關聯原先沒有拿到的欄位資料，而避免進入到 each 的 iterate 的時候，會重複request 。 以下就是簡單的筆記。</p>

<p>看了兩天的 ActiveRecord Association 發現真的好多東西需要去理解~
html 原本的 cart index view</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> &lt;tbody&gt;
</span><span class='line'>        &lt;% current_cart.cart_items.each do |item| %&gt;
</span><span class='line'>        &lt;tr&gt;
</span><span class='line'>            &lt;td&gt;
</span><span class='line'>              &lt;%= link_to(item.product.title, admin_product_path(item.product)) %&gt;
</span><span class='line'>            &lt;/td&gt;
</span><span class='line'>            &lt;td&gt; &lt;%= item.product.price %&gt; &lt;/td&gt;
</span><span class='line'>        &lt;/tr&gt;
</span><span class='line'>  &lt;/tbody&gt;      
</span></code></pre></td></tr></table></div></figure>


<p>原本的 N + 1 queries</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Started</span> <span class="no">GET</span> <span class="s2">&quot;/carts&quot;</span> <span class="k">for</span> <span class="mi">175</span><span class="o">.</span><span class="mi">184</span><span class="o">.</span><span class="mi">245</span><span class="o">.</span><span class="mi">33</span> <span class="n">at</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">31</span> <span class="mo">07</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mo">00</span> <span class="o">+</span><span class="mo">0000</span>
</span><span class='line'><span class="no">Processing</span> <span class="n">by</span> <span class="no">CartsController</span><span class="c1">#index as HTML                                                                                                                                                       </span>
</span><span class='line'>  <span class="no">Cart</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">3</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;carts&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;carts&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;carts&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="mi">20</span> <span class="no">LIMIT</span> <span class="mi">1</span>
</span><span class='line'>  <span class="no">CartItem</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="s2">&quot;cart_items&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;cart_items&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;cart_items&quot;</span><span class="o">.</span><span class="s2">&quot;cart_id&quot;</span> <span class="o">=</span> <span class="p">?</span>  <span class="o">[[</span><span class="s2">&quot;cart_id&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="p">?</span> <span class="no">LIMIT</span> <span class="mi">1</span>  <span class="o">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="o">]]</span>
</span></code></pre></td></tr></table></div></figure>


<p>在 .each 前面，在我們要做 iterate 的 object 後面增加一個 include 作法，讓 Rails 處理 Query 的時候，可以一併一次就先做聯集把 Product 的 detail 資料一起查出來，這樣後面就不用連續查 8 次了，</p>

<p>後來的 cart index view , 增加 : includes(:product)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'> <span class="nt">&lt;tbody&gt;</span>
</span><span class='line'>        <span class="err">&lt;</span>% current_cart.cart_items.includes(:product).each do |item| %&gt;
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>            <span class="nt">&lt;td&gt;</span>
</span><span class='line'>              <span class="err">&lt;</span>%= link_to(item.product.title, admin_product_path(item.product)) %&gt;
</span><span class='line'>            <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>            <span class="nt">&lt;td&gt;</span> <span class="err">&lt;</span>%= item.product.price %&gt; <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tbody&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>我們可以看到 query 已經從前面的 8+1  變成 剩下 3 個 query , 這麼看可能感受還好，但是當這個畫面是類似查詢訂單那種一撈就是20筆, 40筆, 100筆等地記錄，確實就會大大的把query 從101個降到剩3個而已。</p>

<p>經過增加一個include 後的 query</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="no">Cart</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">3</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span>  <span class="s2">&quot;carts&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;carts&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;carts&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="o">=</span> <span class="mi">20</span> <span class="no">LIMIT</span> <span class="mi">1</span>
</span><span class='line'>  <span class="no">CartItem</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="s2">&quot;cart_items&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;cart_items&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;cart_items&quot;</span><span class="o">.</span><span class="s2">&quot;cart_id&quot;</span> <span class="o">=</span> <span class="p">?</span>  <span class="o">[[</span><span class="s2">&quot;cart_id&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="o">]]</span>
</span><span class='line'>  <span class="no">Product</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">4</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="n">*</span> <span class="no">FROM</span> <span class="s2">&quot;products&quot;</span>  <span class="no">WHERE</span> <span class="s2">&quot;products&quot;</span><span class="o">.</span><span class="s2">&quot;id&quot;</span> <span class="no">IN</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>其實我也想過 includes 應該是要放在 controller 或 model 裡面，因為畢竟是要處理 request for data 的動作，怎麼會放在view 裡面? 但目前因為這個購物車網站的 controller 內， current_cart 的 object 是放在 application_controller 裡， view 裡面的  @current_cart.cart_items 是靠著 model 的 association 成立的，所以一時之間就找不到地方去放這個 <code>includes(:product)</code> 了</p>

<p>includes 的用法還有很多，都是為了實現 eager loading ，避免 N+1 queries 的作法。
可以看官方文件 rails api  ActiveRecord 裡面的 <code>Eager loading of associations</code> 章節
<a href="http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to">http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to</a>
或簡單一點的官方文件 rails guide ActiveRecord Query 裡面的 <code>N + 1 查询的解决办法</code>
<a href="http://guides.ruby-china.org/active_record_querying.html">http://guides.ruby-china.org/active_record_querying.html</a></p>

<p>這篇簡單的文章是講放在 controller 裡面的舉例作法
<a href="http://www.sitepoint.com/silver-bullet-n1-problem/">http://www.sitepoint.com/silver-bullet-n1-problem/</a></p>

<p>另外值得一提的是， eager loading 也不是聖杯，因為一次做額外的關聯table，會把一大堆東西一次查詢出來，放到 object內，因此memory會被占掉，要怎麼找到一個平衡，就是 performance tuning 的技巧了，待未來有學習到時，再另行寫一篇筆記吧。</p>

<h1>補充說明:</h1>

<p>另外還有一個用法是 joins .
那麼與 includes 的差別在哪呢?
從上述的說明可以看到使用 includes 的時機是，當我們希望先從 db query 兩個關聯的資料表時，在view 裡面 iterate 的時候不希望造成重複的 query . 那是因為我們需要讀取關聯後的另一個 table 的欄位資料，如上述的 product.title 欄位。</p>

<p>但是，如果我們僅僅需要關聯，而讀取的時候不需要讀取另一個table 的欄位資料時，我們則使用 joins 就好了。
可以看這篇的說明
<a href="http://tomdallimore.com/blog/includes-vs-joins-in-rails-when-and-where/">includes vs joins differences in rails</a></p>

<p>明顯的兩段code 就可以感覺出來了</p>

<figure class='code'><figcaption><span>需要讀取 person table 的 name 的欄位, 所以要使用 includes</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Company</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="ss">:persons</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="ss">:persons</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">active</span><span class="p">:</span> <span class="kp">true</span> <span class="p">}</span> <span class="p">)</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@companies</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">company</span><span class="o">|</span>
</span><span class='line'>     <span class="n">company</span><span class="o">.</span><span class="n">person</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>不需要 person table 裡面的欄位,所以使用 joins</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Company</span><span class="o">.</span><span class="n">joins</span><span class="p">(</span><span class="ss">:persons</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="ss">:persons</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">active</span><span class="p">:</span> <span class="kp">true</span> <span class="p">}</span> <span class="p">)</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>
</span><span class='line'><span class="vi">@companies</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">company</span><span class="o">|</span>
</span><span class='line'>     <span class="n">company</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/27/agile-web-development-with-rails-4-error-handling-error-or-exception-handling/">Agile Web Development With Rails 4 - Error Handling 錯誤或例外處理</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-27T12:04:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:04 pm</span></time>
        
           | <a href="/posts/2014/07/27/agile-web-development-with-rails-4-error-handling-error-or-exception-handling/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/27/agile-web-development-with-rails-4-error-handling-error-or-exception-handling/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>書 p125頁，裡面提到，當處理 error handling / exception handling 的時候，有兩個動作可以做</p>

<blockquote><ol>
<li>we’ll log the fact to an internal log file using Rails’logger facility.</li>
<li>Second, we’ll redisplay the catalog page along with a short message to the user (something along the lines of “Invalid cart”) so they can continue to use our site.</li>
</ol>
</blockquote>

<p>先說明呼叫 invalid_cart() 這個 action 的作法</p>

<figure class='code'><figcaption><span>CartsController</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">CartsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">before_action</span> <span class="ss">:set_cart</span><span class="p">,</span> <span class="ss">only</span><span class="p">:</span> <span class="o">[</span><span class="ss">:show</span><span class="p">,</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:update</span><span class="p">,</span> <span class="ss">:destroy</span><span class="o">]</span>
</span><span class='line'>  <span class="n">rescue_from</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">RecordNotFound</span><span class="p">,</span> <span class="ss">with</span><span class="p">:</span> <span class="ss">:invalid_cart</span>
</span><span class='line'>
</span><span class='line'>    <span class="kp">private</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">set_cart</span>
</span><span class='line'>      <span class="vi">@cart</span> <span class="o">=</span> <span class="no">Cart</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">invalid_cart</span>
</span><span class='line'>      <span class="n">logger</span><span class="o">.</span><span class="n">error</span> <span class="s2">&quot;Attempt to access invalid cart </span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="n">redirect_to</span> <span class="n">store_url</span><span class="p">,</span> <span class="ss">notice</span><span class="p">:</span> <span class="s1">&#39;Invalid cart&#39;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>當 set_cart 的method 被呼叫的時候，會去執行 Cart.find 的呼叫，當發生找不到的時候，就是 exception 發生了
因此隨即就會去呼叫  invalid_cart 的 method, (因為這個controller一開頭就已經宣告了 <code>rescue_from ActiveRecord::RecordNotFound, with: :invalid_cart</code>
因此這個 method 執行的時候，第一步會先log起來，存在 <code>development.log   in the log directory</code>
第二步就會發動把 user 的頁面導回去首頁，並且通過 <code>notice: 'Invalid cart</code> 的flash 方式，告訴使用者錯誤訊息是什麼。</p>

<blockquote><p>延伸閱讀
<a href="http://guides.rubyonrails.org/debugging_rails_applications.html#the-logger">http://guides.rubyonrails.org/debugging_rails_applications.html#the-logger</a></p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/27/agile-web-development-with-rails-4-include-currentcart-sessionid/">Agile Web Development With Rails 4 - Include CurrentCart (使用SessionID)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-27T11:17:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:17 am</span></time>
        
           | <a href="/posts/2014/07/27/agile-web-development-with-rails-4-include-currentcart-sessionid/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/27/agile-web-development-with-rails-4-include-currentcart-sessionid/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在處理把商品放入購物車的時候，我們可以看到 Agile Web Development with Rails 4 裡面的範例是把創造一個購物車拉出去放在 moudle 裡面，然後當需要使用的 controller 要用的時候，會include 包進來，而不會寫死在controller裡面，我猜應該是為了保留彈性與延展性，希望書後面會再提到這個優點是什麼。
跟intermediate 課程的做法不太一樣</p>

<p>書裡面
module 的程式碼如下</p>

<figure class='code'><figcaption><span>current_cart.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#---</span>
</span><span class='line'><span class="c1"># Excerpted from &quot;Agile Web Development with Rails&quot;,</span>
</span><span class='line'><span class="c1"># published by The Pragmatic Bookshelf.</span>
</span><span class='line'><span class="c1"># Copyrights apply to this code. It may not be used to create training material, </span>
</span><span class='line'><span class="c1"># courses, books, articles, and the like. Contact us if you are in doubt.</span>
</span><span class='line'><span class="c1"># We make no guarantees that this code is fit for any purpose. </span>
</span><span class='line'><span class="c1"># Visit http://www.pragmaticprogrammer.com/titles/rails4 for more book information.</span>
</span><span class='line'><span class="c1">#---</span>
</span><span class='line'><span class="k">module</span> <span class="nn">CurrentCart</span>
</span><span class='line'>  <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">private</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">set_cart</span>
</span><span class='line'>      <span class="vi">@cart</span> <span class="o">=</span> <span class="no">Cart</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">session</span><span class="o">[</span><span class="ss">:cart_id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">rescue</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">RecordNotFound</span>
</span><span class='line'>      <span class="vi">@cart</span> <span class="o">=</span> <span class="no">Cart</span><span class="o">.</span><span class="n">create</span>
</span><span class='line'>      <span class="n">session</span><span class="o">[</span><span class="ss">:cart_id</span><span class="o">]</span> <span class="o">=</span> <span class="vi">@cart</span><span class="o">.</span><span class="n">id</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>controller 程式碼如下，
所以當我們在把勾選的商品要放入到購物車的時候，會要 create 一個 LineItems 的物件,再把資料存到這個物件內
因此在這個動作前要先去驗證是否已經有購物車的物件的存在，沒有的話就創造一個出來。
我認為這邊的思維很重要，因為是很抽象，而新手很難聯想到的。</p>

<figure class='code'><figcaption><span>LineItemsController</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">LineItemsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">CurrentCart</span>
</span><span class='line'>  <span class="n">before_action</span> <span class="ss">:set_cart</span><span class="p">,</span> <span class="ss">only</span><span class="p">:</span> <span class="o">[</span><span class="ss">:create</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'> <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>    <span class="n">product</span> <span class="o">=</span> <span class="no">Product</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:product_id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@line_item</span> <span class="o">=</span> <span class="vi">@cart</span><span class="o">.</span><span class="n">line_items</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="ss">product</span><span class="p">:</span> <span class="n">product</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="vi">@line_item</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span> <span class="n">redirect_to</span> <span class="vi">@line_item</span><span class="o">.</span><span class="n">cart</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">notice</span><span class="p">:</span> <span class="s1">&#39;Line item was successfully created.&#39;</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">action</span><span class="p">:</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">status</span><span class="p">:</span> <span class="ss">:created</span><span class="p">,</span> <span class="ss">location</span><span class="p">:</span> <span class="vi">@line_item</span> <span class="p">}</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">action</span><span class="p">:</span> <span class="s1">&#39;new&#39;</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@line_item</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">status</span><span class="p">:</span> <span class="ss">:unprocessable_entity</span> <span class="p">}</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/27/agile-web-development-with-rails-4-before-destroy/">Agile Web Development With Rails 4 - Before_destroy</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-27T10:57:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:57 am</span></time>
        
           | <a href="/posts/2014/07/27/agile-web-development-with-rails-4-before-destroy/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/27/agile-web-development-with-rails-4-before-destroy/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>看到在處理刪除產品的時候，在model裡面要多一個 callback 去檢查 購物車裡面的資料
用來確定使用者現在的購物車內沒有這個商品，不然會很嚴重阿，後台把產品刪掉了
結果客戶走流程走去結帳了，那不就會噴ERROR出來?</p>

<p>這是在上 intermedia class 的時候沒被提到的，趕緊筆記下來，這也就是使用者故事(USER STORY)裡面應該會疏忽的；</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">before_destroy</span> <span class="ss">:ensure_not_referenced_by_any_line_item</span>
</span><span class='line'>
</span><span class='line'><span class="kp">private</span>
</span><span class='line'><span class="n">before_destroy</span> <span class="ss">:ensure_not_referenced_by_any_line_item</span>
</span><span class='line'> <span class="kp">private</span>
</span><span class='line'>    <span class="c1"># ensure that there are no line items referencing this product</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">ensure_not_referenced_by_any_line_item</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">line_items</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>        <span class="k">return</span> <span class="kp">true</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">errors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="ss">:base</span><span class="p">,</span> <span class="s1">&#39;Line Items present&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="k">return</span> <span class="kp">false</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/27/agile-web-development-with-rails-4-cache-fragile/">Agile Web Development With Rails 4 - 快取緩存 Cache</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-27T05:23:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:23 am</span></time>
        
           | <a href="/posts/2014/07/27/agile-web-development-with-rails-4-cache-fragile/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/27/agile-web-development-with-rails-4-cache-fragile/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在讀 Dave Thomas 的這本 Agile Web Development with Rails 4 時，有看到以前不懂的觀念跟技巧，筆記下來。</p>

<p>因為做一個購物網站，當使用者很多的時候，會不斷的發出 http request 要求看產品頁面，所以導致我們的app server 就要不斷的去 request 資料庫。  但實際上，我們的產品資訊，在極短的時間內不會一直變動資料，比如說產品的名稱、說明、圖片價格等等，因此延伸出了上 cache 的功能。如果 rails server 去看一下產品資訊的更動時間沒動過，那就直接把cache的資料打回去給 web server 吐回去給使用者；如果有更新過，那就 request 資料庫，要求重新把新的資料傳上來，然後 cache 然後傳回去給 web server .</p>

<p>實際上怎麼做呢?
1 config/envrionments/development.rb 裡面有
<code>config.action_controller.perfomr_caching</code> 的選項，設為 true.
重開 server
2 在 model 的檔案內增加下列的一個 method . 這邊是以產品table 即 Product model 為範例</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def self.latest
</span><span class='line'>  Product.order(:updated_at).last
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>3 接著我們在我們的 view file 裡面，增加一段檢測更新狀態的 CODE</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;h1&gt;Your Pragmatic Catalog&lt;/h1&gt;
</span><span class='line'>&lt;% cache ['store', Product.latest] do %&gt;
</span><span class='line'>  &lt;% @products.each do |product| %&gt;
</span><span class='line'>    &lt;% cache ['entry', product] do %&gt;
</span><span class='line'>      &lt;div class="entry"&gt;
</span><span class='line'>        &lt;%= image_tag(product.image_url) %&gt;
</span><span class='line'>        &lt;h3&gt;&lt;%= product.title %&gt;&lt;/h3&gt;
</span><span class='line'>        &lt;%= sanitize(product.description) %&gt;
</span><span class='line'>        &lt;div class="price_line"&gt;
</span><span class='line'>          &lt;span class="price"&gt;&lt;%= number_to_currency(product.price) %&gt;&lt;/span&gt;
</span><span class='line'>        &lt;/div&gt;
</span><span class='line'>      &lt;/div&gt;
</span><span class='line'>    &lt;% end %&gt;
</span><span class='line'>  &lt;% end %&gt;
</span><span class='line'>&lt;% end %&gt;</span></code></pre></td></tr></table></div></figure>


<p>這邊用了一個 rails 所提供的一個技巧，叫做 [ Russian Doll Caching ] 俄羅斯娃娃快取(緩存)
因為我們做了兩層的 cache 設定，使用 [] 中括號
第一層命名為 store , 把整個 Product 的 array 依照更新時間排序後 cache 起來
第二層命名為 entry , cache 每一個 product 的元素
這麼做之後，rails 會打理一切剩下的工作，細節可以來看 rails guide 上的解說 及 DHH 的一篇文章
<a href="http://guides.rubyonrails.org/caching_with_rails.html">caching-with-rails @ rails guide </a>
<a href="http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works">how-key-based-cache-expiration-works</a></p>

<p>另外先大推一下 xdite 這篇文章，在講 DHH 如何設計了 cache-digest 的功能使用 MD5 HASH SOURCE CODE 來判斷到底要不要讓 cache expired . 非常厲害
<a href="http://blog.xdite.net/posts/2012/09/03/cache-digest-new-strategy">cache-digest-new-strategy</a></p>

<blockquote><p>本來想嘗試讀一下 rails guide 上的解說，發現有點太難懂了
先暫時不詳細解釋 [] 中括號的內容，以及如何清掉cache &amp; update cache的原理。
讀懂後回來再補上&hellip;</p></blockquote>

<p>最後，要注意的是，我們在開發階段的時候，其實還是要把前述在 config file裡面的值先改回 false,  否則，當我們在調整及修正 view 的template 或內容時，如調整位置、調整表格、CSS等等&hellip; 會發現怎麼按 refresh 都沒有用
那是因為 product 的資料沒有更新的時候, webserver 就直接吐快取回給 browser了，他就不去重新request rails server了，這樣反而會造成開發的時候的困擾。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/24/sublime-setting-configuration-chinese-comment-explaination/">Sublime Setting 設置文件中文解說</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-24T07:31:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>7:31 am</span></time>
        
           | <a href="/posts/2014/07/24/sublime-setting-configuration-chinese-comment-explaination/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/24/sublime-setting-configuration-chinese-comment-explaination/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>本篇來自這裡 <a href="http://my.oschina.net/Twitter/blog/139492">Sublime Text 2 設置文件詳解</a> ，作者是中國的 IT開發者: 金三胖</h3>

<blockquote><blockquote><p>做個備份。 無侵權之用意。</p></blockquote></blockquote>

<p> 看來想駕馭好這軟件不弄清楚配置文件是不行了，周末找了時間把配置文件的每條配置信息都加上了中文注釋，現在貼出來和大家共享，裏面有解釋不清楚的也歡迎大家夥來互相討論:)</p>

<p>另外，這也是我的第一篇博客，以後我會多寫些前端方面的文章和大家共享，歡迎一起討論:)</p>

<p>Preferences.sublime-settings文件：</p>

<p>// While you can edit this file, it’s best to put your changes in
// “User/Preferences.sublime-settings”, which overrides the settings in here.
//
// Settings may also be placed in file type specific options files, for
// example, in Packages/Python/Python.sublime-settings for python files.
{
// Sets the colors used within the text area
// 主題文件的路徑
“color_scheme”: “Packages/Color Scheme – Default/Monokai.tmTheme”,</p>

<p>// Note that the font_face and font_size are overriden in the platform
// specific settings file, for example, “Preferences (Linux).sublime-settings”.
// Because of this, setting them here will have no effect: you must set them
// in your User File Preferences.
// 設置字體和大小，必須在Settings-User裏重寫，這裏設置沒有任何效果
“font_face”: “Consolas”,
“font_size”: 12,</p>

<p>// Valid options are “no_bold”, “no_italic”, “no_antialias”, “gray_antialias”,
// “subpixel_antialias” and “no_round” (OS X only)
// 字體選項：no_bold不顯示粗體字，no_italic不顯示斜體字，no_antialias和no_antialias關閉反鋸齒
// subpixel_antialias和no_round是OS X系統獨有的
“font_options”: [],</p>

<p>// Characters that are considered to separate words
// 在文字上雙擊會全選當前的內容，如果裏面出現以下字符，就會被截斷
“word_separators”: “./\()\”‘-:,.;&lt;>~!@#$%^&amp;*|+=[]{}`~?”,</p>

<p>// Set to false to prevent line numbers being drawn in the gutter
// 是否顯示行號
“line_numbers”: true,</p>

<p>// Set to false to hide the gutter altogether
// 是否顯示行號邊欄
“gutter”: true,</p>

<p>// Spacing between the gutter and the text
// 行號邊欄和文字的間距
“margin”: 4,</p>

<p>// Fold buttons are the triangles shown in the gutter to fold regions of text
// 是否顯示代碼折叠按鈕
“fold_buttons”: true,</p>

<p>// Hides the fold buttons unless the mouse is over the gutter
// 不管鼠標在不在行號邊欄，代碼折叠按鈕一直顯示
“fade_fold_buttons”: true,</p>

<p>// Columns in which to display vertical rulers
//列顯示垂直標尺，在中括號裏填入數字，寬度按字符計算
“rulers”: [],</p>

<p>// Set to true to turn spell checking on by default
// 是否打開拼寫檢查
“spell_check”: false,</p>

<p>// The number of spaces a tab is considered equal to
// Tab鍵制表符寬度
“tab_size”: 4,</p>

<p>// Set to true to insert spaces when tab is pressed
// 設为true時，縮進和遇到Tab鍵時使用空格替代
“translate_tabs_to_spaces”: false,</p>

<p>// If translate_tabs_to_spaces is true, use_tab_stops will make tab and
// backspace insert/delete up to the next tabstop
// translate_tabs_to_spaces設置为true，Tab和Backspace的刪除/插入作用於制表符寬度
// 否則作用於單個空格
“use_tab_stops”: true,</p>

<p>// Set to false to disable detection of tabs vs. spaces on load
// false時禁止在載入的時候檢測制表符和空格
“detect_indentation”: true,</p>

<p>// Calculates indentation automatically when pressing enter
// 按回車時，自動與制表位對齊
“auto_indent”: true,</p>

<p>// Makes auto indent a little smarter, e.g., by indenting the next line
// after an if statement in C. Requires auto_indent to be enabled.
//針對C語言的
“smart_indent”: false,</p>

<p>// Adds whitespace up to the first open bracket when indenting. Requires
// auto_indent to be enabled.
// 需要启用auto_indent，第一次打開括號縮進時插入空格？（沒測試出來效果…）
“indent_to_bracket”: true,</p>

<p>// Trims white space added by auto_indent when moving the caret off the
// line.
// 顯示對齊的白線是否根據回車、tab等操作自動填補
“trim_automatic_white_space”: true,</p>

<p>// Disables horizontal scrolling if enabled.
// May be set to true, false, or “auto”, where it will be disabled for
// source code, and otherwise enabled.
// 是否自動換行，如果選auto，需要加雙引號
“word_wrap”: false,</p>

<p>// Set to a value other than 0 to force wrapping at that column rather than the
// window width
// 設置窗口內文字區域的寬度
“wrap_width”: 0,</p>

<p>// Set to false to prevent word wrapped lines from being indented to the same
// level
// 防止被縮進到同一級的字換行
“indent_subsequent_lines”: true,</p>

<p>// Draws text centered in the window rather than left aligned
// 如果沒有定義過，則文件居中顯示（比如新建的文件）
“draw_centered”: false,</p>

<p>// Controls auto pairing of quotes, brackets etc
// 自動匹配引號，括號等
“auto_match_enabled”: true,</p>

<p>// Word list to use for spell checking
// 拼寫檢查的單詞列表路徑
“dictionary”: “Packages/Language – English/en_US.dic”,</p>

<p>// Set to true to draw a border around the visible rectangle on the minimap.
// The color of the border will be determined by the “minimapBorder” key in
// the color scheme
// 代碼地圖的可視區域部分是否加上邊框，邊框的顏色可在配色方案上加入minimapBorder鍵
“draw_minimap_border”: false,</p>

<p>// If enabled, will highlight any line with a caret
// 突出顯示當前光標所在的行
“highlight_line”: false,</p>

<p>// Valid values are “smooth”, “phase”, “blink”, “wide” and “solid”.
// 設置光標閃動方式
“caret_style”: “smooth”,</p>

<p>// Set to false to disable underlining the brackets surrounding the caret
// 是否特殊顯示當前光標所在的括號、代碼頭尾閉合標記
“match_brackets”: true,</p>

<p>// Set to false if you’d rather only highlight the brackets when the caret is
// next to one
// 設为false時，只有光標在括號或頭尾閉合標記的兩端時，match_brackets才生效
“match_brackets_content”: true,</p>

<p>// Set to false to not highlight square brackets. This only takes effect if
// match_brackets is true
// 是否突出顯示圓括號，match_brackets为true生效
“match_brackets_square”: false,</p>

<p>// Set to false to not highlight curly brackets. This only takes effect if
// match_brackets is true
// 是否突出顯示大括號，match_brackets为true生效
“match_brackets_braces”: false,</p>

<p>// Set to false to not highlight angle brackets. This only takes effect if
// match_brackets is true
// 是否突出顯示尖括號，match_brackets为true生效
“match_brackets_angle”: false,</p>

<p>// Enable visualization of the matching tag in HTML and XML
// html和xml下突出顯示光標所在標簽的兩端，影響HTML、XML、CSS等
“match_tags”: true,</p>

<p>// Highlights other occurrences of the currently selected text
// 全文突出顯示和當前選中字符相同的字符
“match_selection”: true,</p>

<p>// Additional spacing at the top of each line, in pixels
// 設置每一行到頂部，以像素为單位的間距，效果相當於行距
“line_padding_top”: 1,</p>

<p>// Additional spacing at the bottom of each line, in pixels
// 設置每一行到底部，以像素为單位的間距，效果相當於行距
“line_padding_bottom”: 1,</p>

<p>// Set to false to disable scrolling past the end of the buffer.
// On OS X, this value is overridden in the platform specific settings, so
// you’ll need to place this line in your user settings to override it.
// 設置为false時，滾動到文本的最下方時，沒有緩沖區
“scroll_past_end”: true,</p>

<p>// This controls what happens when pressing up or down when on the first
// or last line.
// On OS X, this value is overridden in the platform specific settings, so
// you’ll need to place this line in your user settings to override it.
// 控制向上或向下到第一行或最後一行時發生什麼（沒明白也沒試出來）
“move_to_limit_on_up_down”: false,</p>

<p>// Set to “none” to turn off drawing white space, “selection” to draw only the
// white space within the selection, and “all” to draw all white space
// 按space或tab時，實際會產生白色的點（一個空格一個點）或白色的橫線（tab_size設置的制表符的寬度），選中狀態下才能看到
// 設置为none時，什麼情況下都不顯示這些點和線
// 設置为selection時，只顯示選中狀態下的點和線
// 設置为all時，則一直顯示
“draw_white_space”: “selection”,</p>

<p>// Set to false to turn off the indentation guides.
// The color and width of the indent guides may be customized by editing
// the corresponding .tmTheme file, and specifying the colors “guide”,
// “activeGuide” and “stackGuide”
// 制表位的對齊白線是否顯示，顏色可在主題文件裏設置（guide，activeGuide，stackGuide）
“draw_indent_guides”: true,</p>

<p>// Controls how the indent guides are drawn, valid options are
// “draw_normal” and “draw_active”. draw_active will draw the indent
// guides containing the caret in a different color.
// 制表位的對齊白線，draw_normal为一直顯示，draw_active为只顯示當前光標所在的代碼控制域
“indent_guide_options”: [&ldquo;draw_normal&rdquo;],</p>

<p>// Set to true to removing trailing white space on save
// 为true時，保存文件時會刪除每行結束後多餘的空格
“trim_trailing_white_space_on_save”: false,</p>

<p>// Set to true to ensure the last line of the file ends in a newline
// character when saving
// 为true時，保存文件時光標會在文件的最後向下換一行
“ensure_newline_at_eof_on_save”: false,</p>

<p>// Set to true to automatically save files when switching to a different file
// or application
// 切換到其它文件標簽或點擊其它非本軟件區域，文件自動保存
“save_on_focus_lost”: false,</p>

<p>// The encoding to use when the encoding can’t be determined automatically.
// ASCII, UTF-8 and UTF-16 encodings will be automatically detected.
// 編碼時不能自動檢測編碼時，將自動檢測ASCII, UTF-8 和 UTF-16
“fallback_encoding”: “Western (Windows 1252)”,</p>

<p>// Encoding used when saving new files, and files opened with an undefined
// encoding (e.g., plain ascii files). If a file is opened with a specific
// encoding (either detected or given explicitly), this setting will be
// ignored, and the file will be saved with the encoding it was opened
// with.
// 默認編碼格式
“default_encoding”: “UTF-8″,</p>

<p>// Files containing null bytes are opened as hexadecimal by default
// 包含空字節的文件被打開默認为十六進制
“enable_hexadecimal_encoding”: true,</p>

<p>// Determines what character(s) are used to terminate each line in new files.
// Valid values are ‘system’ (whatever the OS uses), ‘windows’ (CRLF) and
// ‘unix’ (LF only).
// 每一行結束的時候用什麼字符做終止符
“default_line_ending”: “system”,</p>

<p>// When enabled, pressing tab will insert the best matching completion.
// When disabled, tab will only trigger snippets or insert a tab.
// Shift+tab can be used to insert an explicit tab when tab_completion is
// enabled.
// 設置为enabled時，在一個字符串間按Tab將插入一個制表符
// 設置为true時，按Tab會根據前後環境進行代碼自動匹配填補
“tab_completion”: true,</p>

<p>// Enable auto complete to be triggered automatically when typing.
// 代碼提示
“auto_complete”: true,</p>

<p>// The maximum file size where auto complete will be automatically triggered.
// 代碼提示的大小限制
“auto_complete_size_limit”: 4194304,</p>

<p>// The delay, in ms, before the auto complete window is shown after typing
// 代碼提示延遲顯示
“auto_complete_delay”: 50,</p>

<p>// Controls what scopes auto complete will be triggered in
// 代碼提示的控制範圍
“auto_complete_selector”: “source – comment”,</p>

<p>// Additional situations to trigger auto complete
// 觸發代碼提示的其他情況
“auto_complete_triggers”: [ {&ldquo;selector&rdquo;: &ldquo;text.html&rdquo;, &ldquo;characters&rdquo;: &ldquo;&lt;&rdquo;} ],</p>

<p>// By default, auto complete will commit the current completion on enter.
// This setting can be used to make it complete on tab instead.
// Completing on tab is generally a superior option, as it removes
// ambiguity between committing the completion and inserting a newline.
// 設为false時，選擇提示的代碼按回車或點擊可以輸出出來，但選擇true時不會輸出而是直接換行
“auto_complete_commit_on_tab”: false,</p>

<p>// Controls if auto complete is shown when snippet fields are active.
// Only relevant if auto_complete_commit_on_tab is true.
// auto_complete_commit_on_tab必須为true，控制代碼提示的活躍度（沒明白…）
“auto_complete_with_fields”: false,</p>

<p>// By default, shift+tab will only unindent if the selection spans
// multiple lines. When pressing shift+tab at other times, it’ll insert a
// tab character – this allows tabs to be inserted when tab_completion is
// enabled. Set this to true to make shift+tab always unindent, instead of
// inserting tabs.
// 設置为false，使用Shift + tab總是插入制表符
“shift_tab_unindent”: true,</p>

<p>// If true, the selected text will be copied into the find panel when it’s
// shown.
// On OS X, this value is overridden in the platform specific settings, so
// you’ll need to place this line in your user settings to override it.
// 選中的文本按Ctrl + f時，自動复制到查找面板的文本框裏
“find_selected_text”: true,</p>

<p>//
// User Interface Settings
//</p>

<p>// The theme controls the look of Sublime Text’s UI (buttons, tabs, scroll bars, etc)
// Data\Packages\Theme – Default\Default.sublime-theme控制軟件的主題
“theme”: “Default.sublime-theme”,</p>

<p>// Set to 0 to disable smooth scrolling. Set to a value between 0 and 1 to
// scroll slower, or set to larger than 1 to scroll faster
// 滾動的速度
“scroll_speed”: 1.0,</p>

<p>// Controls side bar animation when expanding or collapsing folders
// 左邊邊欄文件夾動畫
“tree_animation_enabled”: true,
// 標簽頁的關閉按鈕
“show_tab_close_buttons”: true,</p>

<p>// OS X 10.7 only: Set to true to disable Lion style full screen support.
// Sublime Text must be restarted for this to take effect.
// 針對OS X
“use_simple_full_screen”: false,</p>

<p>// Valid values are “system”, “enabled” and “disabled”
// 水平垂直滾動條：system和disabled为默認顯示方式，enabled为自動隱藏顯示
“overlay_scroll_bars”: “system”,</p>

<p>//
// Application Behavior Settings
//</p>

<p>// Exiting the application with hot_exit enabled will cause it to close
// immediately without prompting. Unsaved modifications and open files will
// be preserved and restored when next starting.
//
// Closing a window with an associated project will also close the window
// without prompting, preserving unsaved changes in the workspace file
// alongside the project.
// 熱推出功能！退出時不會提示是否保存文件，而是直接退出
// 下次打開軟件時，文件保持退出前的狀態，沒來得及保存的內容都在，但並沒有真實的寫在原文件裏
“hot_exit”: true,</p>

<p>// remember_open_files makes the application start up with the last set of
// open files. Changing this to false will have no effect if hot_exit is
// true
// 軟件使用最後的設定打開文件，hot_exit为true時沒有效果
“remember_open_files”: true,</p>

<p>// OS X only: When files are opened from finder, or by dragging onto the
// dock icon, this controls if a new window is created or not.
// 針對OS X
“open_files_in_new_window”: true,</p>

<p>// Set to true to close windows as soon as the last file is closed, unless
// there’s a folder open within the window. This is always enabled on OS X,
// changing it here won’t modify the behavior.
// 針對OS X
“close_windows_when_empty”: true,
// 哪些文件會被顯示到邊欄上
// folder_exclude_patterns and file_exclude_patterns control which files
// are listed in folders on the side bar. These can also be set on a per-
// project basis.
“folder_exclude_patterns”: [&ldquo;.svn&rdquo;, &ldquo;.git&rdquo;, &ldquo;.hg&rdquo;, &ldquo;CVS&rdquo;],
“file_exclude_patterns”: [&ldquo;<em>.pyc&rdquo;, &ldquo;</em>.pyo&rdquo;, &ldquo;<em>.exe&rdquo;, &ldquo;</em>.dll&rdquo;, &ldquo;<em>.obj&rdquo;,&ldquo;</em>.o&rdquo;, &ldquo;<em>.a&rdquo;, &ldquo;</em>.lib&rdquo;, &ldquo;<em>.so&rdquo;, &ldquo;</em>.dylib&rdquo;, &ldquo;<em>.ncb&rdquo;, &ldquo;</em>.sdf&rdquo;, &ldquo;<em>.suo&rdquo;, &ldquo;</em>.pdb&rdquo;, &ldquo;<em>.idb&rdquo;, &ldquo;.DS_Store&rdquo;, &ldquo;</em>.class&rdquo;, &ldquo;<em>.psd&rdquo;, &ldquo;</em>.db&rdquo;],
// These files will still show up in the side bar, but won’t be included in
// Goto Anything or Find in Files
“binary_file_patterns”: [&ldquo;<em>.jpg&rdquo;, &ldquo;</em>.jpeg&rdquo;, &ldquo;<em>.png&rdquo;, &ldquo;</em>.gif&rdquo;, &ldquo;<em>.ttf&rdquo;, &ldquo;</em>.tga&rdquo;, &ldquo;<em>.dds&rdquo;, &ldquo;</em>.ico&rdquo;, &ldquo;<em>.eot&rdquo;, &ldquo;</em>.pdf&rdquo;, &ldquo;<em>.swf&rdquo;, &ldquo;</em>.jar&rdquo;, &ldquo;*.zip&rdquo;],</p>

<p>// List any packages to ignore here. When removing entries from this list,
// a restart may be required if the package contains plugins.
// 刪除你想要忽略的插件，需要重启
“ignored_packages”: [&ldquo;Vintage&rdquo;]
}</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/posts/2014/07/22/ruby-rails-operator-the-priority/">Ruby (Rails) 內運算式 (Operator)的優先順序 " && " , " == " , " || " 符號</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-22T03:31:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>3:31 am</span></time>
        
           | <a href="/posts/2014/07/22/ruby-rails-operator-the-priority/#disqus_thread"
             data-disqus-identifier="http://dangjlin.github.io/posts/2014/07/22/ruby-rails-operator-the-priority/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>本篇的概念來自於這篇stackover flow 的文章，筆記一下，否則每次看code都會卡住看不懂，不習慣背後的道理就都會很不直覺阿。
<a href="http://stackoverflow.com/questions/5691390/when-do-we-use-the-operator-in-rails-what-is-its-significance">When do we use the “||=” operator in Rails ? What is its significance?</a></p>

<p>例如:  我們可能會看到這種程式碼，一開始的時候都是無法理解這代表什麼含意，是做了什麼判斷? 傳回什麼值? 誰跟誰比對? 優先順序又是什麼?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@_current_user</span> <span class="o">||=</span> <span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>      <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>我們要先講一個觀念是當看到 <code>a ||= b</code> 這種code的時候，要知道它其實是
<code>a || a = b</code> ,
而他所代表的含意是如果 a 本身自己是 nil or false 的時候，則他就會等於 b 的值。 反之，如果 a 不是 nil , 不是 false的時候，那就保持原狀。
詳細的解說可以看這一篇文章
<a href="http://www.rubyinside.com/what-rubys-double-pipe-or-equals-really-does-5488.html">What Ruby’s ||= (Double Pipe / Or Equals) Really Does</a></p>

<p>讓我們來拆解這段程式碼，一步一步的解讀，</p>

<blockquote><p>第一步</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@_current_user</span> <span class="o">||=</span> <span class="p">(</span> <span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span><span class="p">)</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>等同於</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@_current_user</span> <span class="o">||</span> <span class="vi">@_current_user</span> <span class="o">=</span> <span class="p">(</span> <span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">session</span><span class="o">[</span><span class="ss">:current_user_id</span><span class="o">]</span><span class="p">)</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>代表的是如果 @_current_user 是 nil or false 的時候， 就指定為<code>||=</code> 符號右邊的數值，但是右邊又是另一個判斷式，我們進一步解讀。</p>

<blockquote><p>第二步</p></blockquote>

<p>第二個觀念: 這一串  ( session[:current_user_id] &amp;&amp; User.find(session[:current_user_id]) ) 是什麼意思?<br/>
這邊有一個小技巧，如果 session[:current_user_id] 不是 nil or false 那麼 ruby 就會去判斷 &amp;&amp; 符號的右邊的內容 :  如果  User.find(session[:current_user_id]) 也不是 nil ,這樣的話就會傳回 User.find(session[:current_user_id]) 的值。</p>

<p>可以參考這一篇 :  <a href="http://www.appallingfarrago.com/rails/ruby/&amp;&amp;/2013/11/03/ruby-%26%26-shortcut.html">Ruby&rsquo;s &amp;&amp; operator for params</a> 術語上似乎是叫做 <code>short circuit evaluation.</code></p>

<p>第三個觀念: 優先順序的問題
我們可以從 <a href="http://ruby-doc.org/core-2.1.2/doc/syntax/precedence_rdoc.html">ruby document</a> 看到運算子的優先順序，我將這個表複製如下，規則是 <strong><em>越上面的越先運算、執行、判斷</em></strong> ( PS: ruby version 2.1.2 )</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">!</span><span class="p">,</span> <span class="o">~</span><span class="p">,</span> <span class="n">unary</span> <span class="o">+</span>
</span><span class='line'><span class="o">**</span>
</span><span class='line'><span class="n">unary</span> <span class="o">-</span>
</span><span class='line'><span class="o">*</span><span class="p">,</span> <span class="sr">/, %</span>
</span><span class='line'><span class="sr">+, -</span>
</span><span class='line'><span class="sr">&lt;&lt;, &gt;&gt;</span>
</span><span class='line'><span class="sr">&amp;</span>
</span><span class='line'><span class="sr">|, ^</span>
</span><span class='line'><span class="sr">&gt;, &gt;=, &lt;, &lt;=</span>
</span><span class='line'><span class="sr">&lt;=&gt;, ==, ===, !=, =~, !~</span>
</span><span class='line'><span class="sr">&amp;&amp;</span>
</span><span class='line'><span class="sr">||</span>
</span><span class='line'><span class="sr">.., ...</span>
</span><span class='line'><span class="sr">?, :</span>
</span><span class='line'><span class="sr">modifier-rescue</span>
</span><span class='line'><span class="sr">=, +=, -=, etc.</span>
</span><span class='line'><span class="sr">defined?</span>
</span><span class='line'><span class="sr">not</span>
</span><span class='line'><span class="sr">or, and</span>
</span><span class='line'><span class="sr">modifier-if, modifier-unless, modifier-while, modifier-until</span>
</span><span class='line'><span class="sr">{ } blocks</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>第三步</p></blockquote>

<p>所以啦，回到原本的程式碼
當這一串 <code>( session[:current_user_id] &amp;&amp; User.find(session[:current_user_id]) )</code> 先判斷完之後，就知道是 nil 或者是 &amp;&amp; 右邊的值，接著再看  || 的左邊 <code>@_current_user</code> 如果不是 nil or false 就決定是保持原狀，否則就把  User.find(session[:current_user_id]) 指定給  @_current_user 。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/posts/2018/05/02/test-for-new-post/">Test for New Post</a>
      </li>
    
      <li class="post">
        <a href="/posts/2017/02/22/deploy-rails-app-with-mina-and-puma-and-nginx/">如何使用 Mina & Puma & Nginx 部署 Rails - Deploy Rails App With Mina &amp; Puma &amp; Nginx</a>
      </li>
    
      <li class="post">
        <a href="/posts/2017/02/10/how-to-get-improved-to-write-clean-code/">如何寫出clean Code 的參考資料</a>
      </li>
    
      <li class="post">
        <a href="/posts/2016/10/05/rails-using-aws-ses-send-mail-service/">Rails Using AWS SES Send Mail Service</a>
      </li>
    
      <li class="post">
        <a href="/posts/2016/07/19/redmine-aws-s3-problem-hack-workaround/">Redmine 串 AWS S3 遇到的問題 Hack Workaround</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Daniel Lin 丹哥 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dangjlin';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
